(()=>{"use strict";function e(){if(t)try{o(!1),document.getElementsByClassName("alert")[0].classList.remove("icPanelAdded"),document.getElementsByClassName("span")[0].classList.remove("turnSpanVisible"),document.getElementsByClassName("icon")[0].classList.remove("moveIcon"),document.getElementsByClassName("icPanel")[0].remove()}catch(e){console.log("Erro ao remover o painel: ",e)}else try{o(!0);var e=function(){try{return document.getElementsByClassName("LogoutButton")[0].href.toString().split("ChallengeToken=")[1].replace(";","")}catch(e){console.log(e)}}().toString(),a=n();document.getElementsByClassName("alert")[0].classList.add("icPanelAdded"),document.getElementsByClassName("span")[0].classList.add("turnSpanVisible"),document.getElementsByClassName("icon")[0].classList.add("moveIcon"),document.getElementsByTagName("body")[0].insertAdjacentHTML("afterbegin",`\n            <div class="icPanel">\n                <div class="header">\n                    <h2 class="title">Adicionar IC</h2>\n                </div>\n                <div class="options">\n                    <button class="button"><a class="linkButton" href="https://suportedti.agu.gov.br/otrs/index.pl?ChallengeToken=${e}&Action=AgentLinkObject&Mode=Normal&SourceObject=Ticket&SourceKey=${a}&TargetIdentifier=ITSMConfigItem%3A%3A139&SEARCH%3A%3ANumber=&SEARCH%3A%3AName=biblioteca&SubmitSearch=Procurar&TypeIdentifier=AlternativeTo%3A%3ASource&SubmitLink=Procurar&AddIc" target="_blanck">Bib. Software</a></button>\n                    <button class="button"><a class="linkButton" href="https://suportedti.agu.gov.br/otrs/index.pl?ChallengeToken=${e}&Action=AgentLinkObject&Mode=Normal&SourceObject=Ticket&SourceKey=${a}&TargetIdentifier=ITSMConfigItem%3A%3A168&SEARCH%3A%3ANumber=&SEARCH%3A%3AName=SDFURA0031&SubmitSearch=Procurar&TypeIdentifier=AlternativeTo%3A%3ASource&SubmitLink=Procurar&AddIc" target="_blanck">Reset de senha</a></button>\n                    <button class="button"><a class="linkButton" href="https://suportedti.agu.gov.br/otrs/index.pl?ChallengeToken=${e}&Action=AgentLinkObject&Mode=Normal&SourceObject=Ticket&SourceKey=${a}&TargetIdentifier=ITSMConfigItem%3A%3A168&SEARCH%3A%3ANumber=&SEARCH%3A%3AName=SDF0432&SubmitSearch=Procurar&TypeIdentifier=AlternativeTo%3A%3ASource&SubmitLink=Procurar&AddIc" target="_blanck">Alt. na conta</a></button>\n                    <button class="button"><a class="linkButton" href="https://suportedti.agu.gov.br/otrs/index.pl?ChallengeToken=${e}&Action=AgentLinkObject&Mode=Normal&SourceObject=Ticket&SourceKey=${a}&TargetIdentifier=ITSMConfigItem%3A%3A168&SEARCH%3A%3ANumber=&SEARCH%3A%3AName=SDF0814+&SubmitSearch=Procurar&TypeIdentifier=AlternativeTo%3A%3ASource&SubmitLink=Procurar&AddIc" target="_blanck">Desativar conta</a></button>\n                    <button class="button"><a class="linkButton" href="https://suportedti.agu.gov.br/otrs/index.pl?ChallengeToken=${e}&Action=AgentLinkObject&Mode=Normal&SourceObject=Ticket&SourceKey=${a}&TargetIdentifier=ITSMConfigItem%3A%3A168&SEARCH%3A%3ANumber=&SEARCH%3A%3AName=SDFURA0117&SubmitSearch=Procurar&TypeIdentifier=AlternativeTo%3A%3ASource&SubmitLink=Procurar&AddIc" target="_blanck">Criar conta</a></button>\n                    <button class="button"><a class="linkButton" href="https://suportedti.agu.gov.br/otrs/index.pl?Action=AgentLinkObject;SourceObject=Ticket;SourceKey=${a}" target="_blanck">Inserir manual</a></button>\n                </div>\n            </div>\n            `)}catch(e){console.log("Erro ao injetar painel: ",e)}}let t=!1;function n(){try{const e=window.location.href.split("TicketID=")[1];return e.length>6?e.slice(0,6):e}catch(e){console.log(e)}}function o(e){t=e}function a(e){const t=e.split(":");return(new Date).setHours(t[0],t[1])}function c(e=1){if(10==e)return null;let t=/([0-9]+)/i;const n=document.querySelector(".Headline").querySelector("h1").textContent,o=t.exec(n)[0];t=/([A-Za-z]+( [A-Za-z]+)+)/i;const a=document.querySelector(".UserAvatar").querySelector("div").textContent,r=t.exec(a)[0];let i="",l="";const s=document.querySelectorAll("label");for(let e=0;e<s.length;e++)"Nome Completo:"==s[e].textContent&&(i=s[e].nextElementSibling.title),"E-mail:"==s[e].textContent&&(l=s[e].nextElementSibling.title);return""==i||""==l?(setTimeout((function(){}),1500),c(e++)):(t=/—\s(.*)/i,{numChamado:o,tecName:r,userName:i,userEmail:l,subject:t.exec(n)[1]})}function r(){const{userEmail:e,userName:t,tecName:n,numChamado:o,subject:a}=c(),r=document.createElement("label");r.textContent="Teams:";const i=document.createElement("p");i.title="Link para conversa no Teams",i.className="Value FixedValueSmall";const l=document.createElement("a");let s;const d=(new Date).getHours();s=d>5&&d<12?"Bom dia":d<18?"Boa tarde":"Boa noite",l.href=`https://teams.microsoft.com/l/chat/0/0?users=${e}&message=${s} Sr(a) ${t}! Meu nome é ${n}, Técnico de Suporte da Empresa Hepta. O motivo do meu contato é referente ao Chamado ${o}, com assunto: ${a}.`,l.textContent="Conversar no Teams",l.target="_blank",i.insertAdjacentElement("afterbegin",l);const u=document.createElement("div");u.className="Clear";const m=document.getElementsByClassName("TableLike FixedLabelSmall Narrow");m[m.length-1].insertAdjacentElement("afterbegin",r),r.insertAdjacentElement("afterend",i),i.insertAdjacentElement("afterend",u)}function i(e){try{const e=document.querySelectorAll(".Tab.Actions")[1],t=document.querySelector("#Dashboard9906-Chamados-Pendentes-box");if(4==e.children.length){const n=document.createElement("p");n.textContent="Carregar todas as RDM's",n.style="color: gray;cursor: pointer;";const o=document.createElement("li");o.appendChild(n),e.appendChild(o),n.addEventListener("click",(()=>{Array.from(t.getElementsByTagName("tr")).forEach((e=>{!async function(e){try{if(!e.getAttribute("rdm-info")){const t=document.createElement("span");t.className="loader",Array.from(e.getElementsByTagName("div")).find((e=>"Pendente da Mudança"===e.textContent)).insertAdjacentElement("beforeend",t);const n=await async function(e){try{const t=await fetch(e),n=await t.text(),o=(new DOMParser).parseFromString(n,"text/html").querySelectorAll(".DataTable");return o[o.length-1].getElementsByTagName("span")[1].textContent}catch{}}(e.getElementsByTagName("a")[0].href);t.className="info",t.textContent=`: ${n}`}}catch{}}(e)}))}))}}catch{}}function l(e){try{const t=document.getElementById("context-menu"),n=document.getElementById("close-menu-button");Array.from(e.getElementsByTagName("tr")).forEach((e=>{function o(){t.style.display="none",document.removeEventListener("click",o)}e.addEventListener("contextmenu",(a=>{a.preventDefault();const c=e.querySelector(".AsBlock.MasterActionLink").href.replace("Zoom","Note")+";AddNoteAuto";document.querySelector("#link-chamado").setAttribute("href",c),t.style.left=`${a.clientX}px`,t.style.top=`${a.clientY+window.scrollY}px`,t.style.display="block",n.addEventListener("click",o),document.addEventListener("click",o),document.addEventListener("keydown",(e=>{"Escape"===e.key&&o()}))}))}))}catch(e){console.log("Erro no trEventlistener:",e)}}function s(){const t=function(e){let t=!1;for(let n=0;n<e.length;n++)try{e[n].getElementsByTagName("h2")[0]?.textContent.toString().includes("ConfigItem")&&(t=!0)}catch(e){console.log("icVerifier error: "+e)}return t}(document.querySelectorAll(".WidgetSimple .Header")),o=function(){try{return document.querySelector(".Headline").querySelector("h1").textContent.includes("Chamado#")}catch(e){}}(),c=function(){try{return null!=document.querySelector("#LinkAddCloseLink")}catch(e){console.log(e)}}(),s=function(){try{return document.querySelector("#nav-Dashboard").classList.contains("Selected")}catch(e){return!1}}();if(o&&(setTimeout((()=>{r()}),1e3),t||function(){const t=document.getElementsByTagName("body")[0];n(),t.insertAdjacentHTML("afterbegin",'\n        <div class="alert">\n            <h1 class="icon">!</h1>\n            <span class="span">\n                IC Não Associado!\n            </span>\n        </div>\n    '),document.getElementsByClassName("alert")[0].addEventListener("click",e)}()),s){document.getElementsByTagName("body")[0].insertAdjacentHTML("beforeend",'\n    <div id="context-menu">\n        <div id="close-menu-button">\n            <span>x</span>\n        </div>\n        <ul id="menu-list">\n            <li id="load-page"><a id="link-chamado" target="_blank">Em atendimento</a></li>\n        </ul>\n    </div>\n    '),function(){const e=[document.querySelector("#Dashboard9902-Chamados-N2"),document.querySelector("#Dashboard9906-Chamados-Pendentes")];Array.from(e).forEach((e=>{try{l(e),i();const t=new MutationObserver((()=>{l(e),i()})),n={attributes:!0,childList:!0,subtree:!0};t.observe(e,n)}catch(e){console.log("Erro no Observer:",e)}}))}();const e=function(){const e=new Date,t=document.getElementsByClassName("EventDetails"),n=[];for(let o=0;o<t.length;o++){const c=t[o].getElementsByClassName("Value");if(e.toLocaleDateString()==c[9].textContent.split(" ")[0]){const r=c[5].textContent,i=c[6].textContent,l=c[8].textContent.split(" ")[1],s=c[9].textContent.split(" ")[1],d=t[o].getAttribute("id").split("-")[2];let u=(a(l)-e.getTime())/1e3/60;if("Aguardando Validação"==r||"Em Atendimento"==r)continue;if(u>=15)continue;n.push({estado:r,titulo:i,inicio:l,termino:s,link:d})}}return n.sort(((e,t)=>e.inicio.localeCompare(t.inicio)))}();e.length>0&&function(e){const t=document.getElementsByTagName("body")[0];let n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),c=document.createElement("h1"),r=document.createElement("img"),i=document.createElement("span"),l=document.createElement("div");t.appendChild(n),n.appendChild(o),n.appendChild(a),a.appendChild(c),a.appendChild(i),c.appendChild(r),n.setAttribute("class","alert events"),c.setAttribute("class","icon"),r.setAttribute("src","https://cdn-icons-png.flaticon.com/512/3652/3652191.png"),i.setAttribute("class","span"),i.innerHTML="Agendamentos",l.setAttribute("class","agendamentos"),a.setAttribute("class","footer"),o.setAttribute("class","container");for(let t=0;t<e.length;t++){let n=document.createElement("a"),o=document.createElement("div"),a=document.createElement("p"),c=document.createElement("p");n.setAttribute("class","evento"),n.setAttribute("href",`https://suportedti.agu.gov.br/otrs/index.pl?Action=AgentTicketZoom;TicketID=${e[t].link}`),n.setAttribute("target","_blanck"),o.setAttribute("class","horario"),n.appendChild(o),o.appendChild(a),o.appendChild(c),a.textContent=e[t].inicio,c.textContent=e[t].termino;let r=document.createElement("p"),i=document.createElement("p");n.appendChild(r),n.appendChild(i),r.textContent=e[t].titulo,i.textContent=e[t].estado,l.appendChild(n)}n.addEventListener("mouseenter",(()=>{o.appendChild(l)}),!1),n.addEventListener("mouseleave",(()=>{try{o.removeChild(l)}catch(e){console.log("Error: "+e)}}),!1)}(e)}if(c)try{0==document.getElementsByClassName("MessageBox Info").length?document.URL.includes("AddIc")&&(document.getElementById("LinkTargetKeys").click(),document.getElementById("AddLinks").click(),document.querySelector("body").insertAdjacentHTML("afterbegin",'\n            <div class="loading">\n                <span class="loader"></span>\n            </div>\n            ')):window.close()}catch(e){console.log("Erro ao adicionar IC: ",e)}document.URL.includes("AddNoteAuto")&&window.addEventListener("load",(()=>{setTimeout((()=>{document.querySelector("#NewStateID").querySelectorAll("option").forEach((e=>{14==e.value&&(e.selected=!0,document.querySelector("#Subject").setAttribute("value","Em atendimento"),document.querySelector("#Subject").textContent="Em atendimento",document.querySelector("#cke_RichText").querySelector("iframe").contentDocument.querySelector(".cke_editable.cke_editable_themed.cke_contents_ltr.cke_show_borders").textContent="Em atendimento",document.querySelector("#submitRichText").click())}))}),1500)}))}"loading"==document.readyState?document.addEventListener("DOMContentLoaded",s):s()})();