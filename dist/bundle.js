(()=>{"use strict";function e(){try{return"https://suportedti.agu.gov.br/otrs/index.pl?Action=AgentDashboard"==document.URL}catch(e){return!1}}function t(e){const t=e.split(":");return(new Date).setHours(t[0],t[1])}function n(){const n=function(e){let t=!1;for(let n=0;n<e.length;n++)try{e[n].getElementsByTagName("h2")[0]?.textContent.toString().includes("ConfigItem")&&(t=!0)}catch(e){console.log("icVerifier error: "+e)}return t}(document.querySelectorAll(".WidgetSimple .Header"));if(function(){try{return document.querySelector(".Headline").querySelector("h1").textContent.includes("Chamado#")}catch(e){}}()&&(setTimeout((()=>{!function(){const e=function(){let e=/([0-9]+)/i;const t=document.querySelector(".Headline").querySelector("h1").textContent,n=e.exec(t)[0];e=/([A-Za-z]+( [A-Za-z]+)+)/i;const o=document.querySelector(".UserAvatar").querySelector("div").textContent,a=e.exec(o)[0];return e=/—\s(.*)/i,{numChamado:n,tecName:a,userName:document.querySelectorAll(".FixedValueSmall")[4].title,userEmail:document.querySelectorAll(".FixedValueSmall")[6].title,subject:e.exec(t)[1]}}(),t=document.createElement("label");t.textContent="Teams:";const n=document.createElement("p");n.title="Link para conversa no Teams",n.className="Value FixedValueSmall";const o=document.createElement("a");let a;const c=(new Date).getHours();a=c>5&&c<12?"Bom dia":c<18?"Boa tarde":"Boa noite",o.href=`https://teams.microsoft.com/l/chat/0/0?users=${e.userEmail}&message=${a} Sr(a) ${e.userName}! Meu nome é ${e.tecName}, Técnico de Suporte da Empresa Hepta. O motivo do meu contato é referente ao Chamado ${e.numChamado}, com assunto: ${e.subject}.`,o.textContent="Conversar no Teams",o.target="_blank",n.insertAdjacentElement("afterbegin",o);const l=document.createElement("div");l.className="Clear";const i=document.getElementsByClassName("TableLike FixedLabelSmall Narrow");i[i.length-1].insertAdjacentElement("afterbegin",t),t.insertAdjacentElement("afterend",n),n.insertAdjacentElement("afterend",l)}()}),1e3),n||function(){const e=document.getElementsByTagName("body")[0],t=function(){try{const e=window.location.href.split("TicketID=")[1];return e.length>6?e.slice(0,6):e}catch(e){console.log(e)}}();e.insertAdjacentHTML("afterbegin",`\n    <a class="alert" title="Clique para adicionar o IC" href="https://suportedti.agu.gov.br/otrs/index.pl?Action=AgentLinkObject;SourceObject=Ticket;SourceKey=${t}" target="_blanck">\n        <div class="alert">\n            <h1 class="icon">!</h1>\n            <span class="span">\n                IC Não Associado!\n            </span>\n        </div>\n    </a>\n    `)}()),e){const e=function(){const e=new Date,n=document.getElementsByClassName("EventDetails"),o=[];for(let a=0;a<n.length;a++){const c=n[a].getElementsByClassName("Value");if(e.toLocaleDateString()==c[9].textContent.split(" ")[0]){const l=c[5].textContent,i=c[6].textContent,r=c[8].textContent.split(" ")[1],s=c[9].textContent.split(" ")[1],d=n[a].getAttribute("id").split("-")[2];let m=(t(r)-e.getTime())/1e3/60;if(console.log(i,r,m,t(r),e),"Aguardando Validação"==l||"Em Atendimento"==l){console.log("if 1");continue}if(m>=15){console.log("if 2");continue}o.push({estado:l,titulo:i,inicio:r,termino:s,link:d})}}return o.sort(((e,t)=>e.inicio.localeCompare(t.inicio)))}();e.length>0&&function(e){const t=document.getElementsByTagName("body")[0];let n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),c=document.createElement("h1"),l=document.createElement("img"),i=document.createElement("span"),r=document.createElement("div");t.appendChild(n),n.appendChild(o),n.appendChild(a),a.appendChild(c),a.appendChild(i),c.appendChild(l),n.setAttribute("class","alert events"),c.setAttribute("class","icon"),l.setAttribute("src","https://cdn-icons-png.flaticon.com/512/3652/3652191.png"),i.setAttribute("class","span"),i.innerHTML="Agendamentos",r.setAttribute("class","agendamentos"),a.setAttribute("class","footer"),o.setAttribute("class","container");for(let t=0;t<e.length;t++){let n=document.createElement("a"),o=document.createElement("div"),a=document.createElement("p"),c=document.createElement("p");n.setAttribute("class","evento"),n.setAttribute("href",`https://suportedti.agu.gov.br/otrs/index.pl?Action=AgentTicketZoom;TicketID=${e[t].link}`),n.setAttribute("target","_blanck"),o.setAttribute("class","horario"),n.appendChild(o),o.appendChild(a),o.appendChild(c),a.textContent=e[t].inicio,c.textContent=e[t].termino;let l=document.createElement("p"),i=document.createElement("p");n.appendChild(l),n.appendChild(i),l.textContent=e[t].titulo,i.textContent=e[t].estado,r.appendChild(n)}n.addEventListener("mouseenter",(()=>{o.appendChild(r)}),!1),n.addEventListener("mouseleave",(()=>{try{o.removeChild(r)}catch(e){console.log("Error: "+e)}}),!1)}(e)}}"loading"==document.readyState?document.addEventListener("DOMContentLoaded",n):n()})();